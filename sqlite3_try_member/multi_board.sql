-- SQLite

CREATE TABLE AUTHORITY
(
  CODE_ID TEXT NOT NULL,
  NAME    TEXT NULL    ,
  PRIMARY KEY (CODE_ID)
);

CREATE TABLE DEPARTMENT
(
  DEP_ID TEXT NOT NULL,
  NAME   TEXT NULL    ,
  PRIMARY KEY (DEP_ID)
);

CREATE TABLE HOBBY
(
  NAME     TEXT NULL    ,
  HOBBY_ID TEXT NOT NULL,
  PRIMARY KEY (HOBBY_ID)
);

CREATE TABLE MEMBER
(
  MEMBER_ID TEXT NOT NULL,
  NAME      TEXT NULL    ,
  AGE       REAL NULL    ,
  ADDRESS   TEXT NULL    ,
  SALARY    REAL NULL    ,
  DEP_ID    TEXT NOT NULL,
  PRIMARY KEY (MEMBER_ID)
    CONSTRAINT FK_DEPARTMENT_TO_MEMBER
    FOREIGN KEY (DEP_ID)
    REFERENCES DEPARTMENT (DEP_ID)
);

CREATE TABLE MEMBER_AUTHORITY
(
  MEMBER_ID TEXT NOT NULL,
  CODE_ID   TEXT NOT NULL,
    CONSTRAINT FK_MEMBER_TO_MEMBER_AUTHORITY
    FOREIGN KEY (MEMBER_ID)
    REFERENCES MEMBER (MEMBER_ID)
    CONSTRAINT FK_AUTHORITY_TO_MEMBER_AUTHORITY
    FOREIGN KEY (CODE_ID)
    REFERENCES AUTHORITY (CODE_ID)
);

CREATE TABLE MEMBER_HOBBY
(
  MEMBER_ID TEXT NOT NULL,
  HOBBY_ID  TEXT NOT NULL,
    CONSTRAINT FK_MEMBER_TO_MEMBER_HOBBY
    FOREIGN KEY (MEMBER_ID)
    REFERENCES MEMBER (MEMBER_ID)
    CONSTRAINT FK_HOBBY_TO_MEMBER_HOBBY
    FOREIGN KEY (HOBBY_ID)
    REFERENCES HOBBY (HOBBY_ID)
);


INSERT INTO MEMBER VALUES ('P_IT', 'Paul', 32, 'California', 20000, 'IT') ;
INSERT INTO MEMBER VALUES ('A_E', 'Allen', 25, 'Texas', 15000, 'ENGN') ;
INSERT INTO MEMBER VALUES ('T_IT', 'Teddy', 23, 'Norway', 20000, 'IT') ;
INSERT INTO MEMBER VALUES ('J_IT','James', 44, 'Norway', 5000, 'IT') ;

INSERT INTO HOBBY VALUES ('Walk' , 'h1') ;
INSERT INTO HOBBY VALUES ('Climbing' , 'h2') ;
INSERT INTO HOBBY VALUES ('Read' , 'h3') ;

INSERT INTO MEMBER_HOBBY VALUES ('P_IT' , 'h1');
INSERT INTO MEMBER_HOBBY VALUES ('P_IT' , 'h2');
INSERT INTO MEMBER_HOBBY VALUES ('P_IT' , 'h3');
INSERT INTO MEMBER_HOBBY VALUES ('A_E' , 'h1');
INSERT INTO MEMBER_HOBBY VALUES ('A_E' , 'h3');
INSERT INTO MEMBER_HOBBY VALUES ('T_IT' , 'h2');
INSERT INTO MEMBER_HOBBY VALUES ('T_IT' , 'h3');
INSERT INTO MEMBER_HOBBY VALUES ('J_IT' , 'h1');

INSERT INTO DEPARTMENT VALUES ('IT','IT BILLING');
INSERT INTO DEPARTMENT VALUES ('ENGN','ENGINEERING');

--EMAIL 칼럼 추가 
ALTER TABLE MEMBER ADD COLUMN EMAIL;
--EMAIL 값 추가
UPDATE MEMBER SET EMAIL='paul01@gmail.com' WHERE MEMBER_ID='P_IT' ;
UPDATE MEMBER SET EMAIL='texas@imfblog.org' WHERE MEMBER_ID='A_E' ;
UPDATE MEMBER SET EMAIL='norway@iotm.com' WHERE MEMBER_ID='T_IT' ;

INSERT INTO AUTHORITY VALUES ('code1' , 'GUEST') ;
INSERT INTO AUTHORITY VALUES ('code2' , 'ADMIN') ;
INSERT INTO AUTHORITY VALUES ('code3' , 'MANAGER') ;

INSERT INTO MEMBER_AUTHORITY VALUES ('P_IT' , 'code1');
INSERT INTO MEMBER_AUTHORITY VALUES ('P_IT' , 'code2');
INSERT INTO MEMBER_AUTHORITY VALUES ('P_IT' , 'code3');
INSERT INTO MEMBER_AUTHORITY VALUES ('A_E' , 'code2');
INSERT INTO MEMBER_AUTHORITY VALUES ('A_E' , 'code3');
INSERT INTO MEMBER_AUTHORITY VALUES ('T_IT' , 'code2');

--게시판 Table 추가
CREATE TABLE MULTI_BOARD
(
  TITLE     TEXT NULL    ,
  CONTENTS  TEXT NULL    ,
  CONT_CODE TEXT NOT NULL,
  MEMBER_ID TEXT NOT NULL,
  PRIMARY KEY (CONT_CODE)
    CONSTRAINT FK_MEMBER_TO_MULTI_BOARD
    FOREIGN KEY (MEMBER_ID)
    REFERENCES MEMBER (MEMBER_ID)
    CONSTRAINT FK_MULTI_BOARD_TO_FILE
    FOREIGN KEY (CONT_CODE)
    REFERENCES MULTI_BOARD (CONT_CODE)
);
CREATE TABLE FILE
(
  IMAGE     TEXT NOT NULL,
  CONT_CODE TEXT NOT NULL,
  PRIMARY KEY (IMAGE)
);

-- DROP TABLE MULTI_BOARD;
-- DROP TABLE FILE;

INSERT INTO MULTI_BOARD VALUES ('용감한 가족', '한국영화장르', '001', 'P_IT');
INSERT INTO MULTI_BOARD VALUES ('용감한 형제', '일본영화장르', '002', 'T_IT');
INSERT INTO MULTI_BOARD VALUES ('용감한 친척', '미국영화장르', '003', 'T_IT');

INSERT INTO FILE VALUES ('poster.png', '001');
INSERT INTO FILE VALUES ('actor.png', '001');
INSERT INTO FILE VALUES ('poster02.png', '002');
INSERT INTO FILE VALUES ('actor.02.png', '002');
INSERT INTO FILE VALUES ('poster03.png', '003');
INSERT INTO FILE VALUES ('actor.03.png', '003');

--SELECT
SELECT TITLE, CONTENTS, IMAGE, NAME FROM MULTI_BOARD, FILE, MEMBER
WHERE MEMBER.MEMBER_ID = MULTI_BOARD.MEMBER_ID AND FILE.CONT_CODE = MULTI_BOARD.CONT_CODE;
